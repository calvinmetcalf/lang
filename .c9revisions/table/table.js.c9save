{"ts":1340797274718,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"google.load('visualization', '1.0', {'packages':['corechart','table']});\r\n\r\n$(function() {\r\n    $( \"#tabs\" ).tabs({\r\n    collapsible: true,\r\n    selected: -1\r\n});\r\nvar v = google.visualization;\r\n$.get(\"https://otp.iriscouch.com/lang/_design/stats/_view/Unique?group=true\",table,\"JSONP\");\r\nfunction table(d){\r\nvar k=$.map(d.rows,function(r){\r\n    return r.key;\r\n});\r\n$(\"#chart\").append(\"<div id='tabs'><ul id='tab-list'><li><a href='#tabs-1'>Towns</a></li></ul><div id='tabs-1'<form id='tform'><input id='towns' type='text' /></form></div></div><div id='viz'></div>\");\r\n$( \"#tabs\" ).tabs({collapsible: true,selected: -1});\r\nvar kcap = $.map(k,function(v){\r\nvar u = v.trim().split(\" \");\r\nvar up =$.map(u,function(uu){\r\n uuu = uu.slice(0,1).toUpperCase() + uu.slice(1);\r\n return uuu;\r\n});\r\nreturn up.join(\" \");\r\n});\r\n$( \"#towns\" ).autocomplete({\r\n    \t\tsource: kcap\r\n\t\t});\r\n$(\"#tform\").submit(function(){\r\n    v = $( \"#towns\" ).val();\r\n    makeChart(v);\r\n    })\r\n};\r\nfunction getChart(town){\r\n $.get(\"http://otp.iriscouch.com/lang/\" + town,cb,\"JSONP\");\r\n function cb(data){\r\n     makeChart(data,town);\r\n    \r\n }\r\nfunction makeChart(d,t){\r\n    var r = new google.visualization.DataTable();\r\nr.addColumn('string','Language');\r\nr.addColumn('number','Speakers');\r\n$.each(d,function(k,v){\r\n    if(!((k==\"_id\")&&(k==\"_rev\")&&(k==\"Total\"))){\r\n     r.addRow([k,v]);   \r\n    }\r\n});\r\nvar table = new google.visualization.Table(document.getElementById('viz');\r\ntable.draw(r);\r\n    \r\n}\r\n}\r\n});"]],"start1":0,"start2":0,"length1":0,"length2":1478}]],"length":1478}
