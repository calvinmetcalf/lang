{"ts":1341314548019,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"google.load('visualization', '1.0', {'packages':['corechart','table']});\r\nvar m,marker,poly,p;\r\nvar g = google.maps;\r\n$(function() {\r\n;\r\nvar lat,lng;\r\n\r\n\r\nvar ls = \"Total,poly,'English Bilingual','English Only','Other African',Arabic,Armenian,Chinese,French,'Haitian Creole',German,Greek,Gujarati,Hebrew,Hindi,Hmong,Hungarian,Italian,Japanese,Korean,Laotian,Cambodian,'Other Misc','Other Asian','Other Indic','Other Indo-European','Other Native','Other Pacific Island','Other Slavic','Other West Germanic',Persian,Polish,Portuguese,Russian,'Other Scandinavian','Serbo-Croatian',Spanish,Tagalog,Thai,Urdu,Vietnamese,Yiddish\"\r\nvar base =\"https://www.googleapis.com/fusiontables/v1/query?sql=SELECT%20\"+ls+\"%20FROM%201Nmn4ITGyXRucIE52dt55mEhy7RWKm_s55f3dOhg+WHERE%20ST_INTERSECTS(poly,%20CIRCLE(LATLNG(\";\r\n\r\nvar end =\"),5))&key=AIzaSyAm9yWCV7JPCTHCJut8whOjARd7pwROFDQ\";\r\nuiStuff();\r\nfunction getTract(lat,lng){\r\n    var latlng =[lat,lng].join(\",\");\r\n$.get(base+latlng+end,dc,\"JSONP\");\r\n}\r\nfunction dc(data){\r\n    var d={};\r\n   $.each(data.rows[0],function(i,v){\r\n    if(v>0){\r\n     d[data.columns[i]]=v\r\n    }\r\n   });\r\n makeChart(d);\r\n sMap(data.rows[0][1]);\r\n}\r\nfunction gc(a){\r\n\r\nvar geoc = new g.Geocoder();\r\ngeoc.geocode( { 'address': a}, function(results, status) {\r\n     if (status == g.GeocoderStatus.OK) {\r\n          cb(results[0].geometry.location);\r\n     }\r\n});\r\n};\r\nfunction cb(loc){\r\nlat = loc.lat();\r\nlng = loc.lng();\r\ngetTract(lat,lng);\r\nmakeMap();\r\n}\r\n\r\nfunction makeChart(d){\r\n    var r = new google.visualization.DataTable();\r\nr.addColumn('string','Language');\r\nr.addColumn('number','Speakers');\r\n\r\n$.each(d,function(k,v){\r\n   if((k!=\"Total\")&&(k!==\"poly\")){\r\n    r.addRow([k,parseInt(v)]);\r\n   \r\n   }\r\n});\r\nvar t= new google.visualization.Table(document.getElementById('tabs-1'));\r\nvar c= new google.visualization.PieChart(document.getElementById('tabs-2'));\r\nt.draw(r,{sortColumn:1,sortAscending:false});\r\nvar o = {'width':900,\r\n                      'height':400,\r\n                       'chartArea':{'left':0,\r\n                       'width':'100%',\r\n                       'height':'80%'},\r\n                      'titleTextStyle':{\r\n                      'fontSize':20\r\n                      },\r\n                       'is3D':true};\r\nc.draw(r,o);\r\n}\r\nfunction makeMap(){\r\n    var center = new g.LatLng(lat,lng)\r\n   $('#tabs').bind('tabsshow', function(event, ui) {\r\n    if (ui.panel.id == \"map\") {\r\n       g.event.trigger(m,\"resize\");\r\n       m.setCenter(center);\r\n    }\r\n});\r\n    \r\n    m = new g.Map(document.getElementById('map'), {\r\n    center: center,\r\n    zoom: 15,\r\n    mapTypeId: 'roadmap'\r\n});\r\np= new g.FusionTablesLayer({\r\n   suppressInfoWindows:true,\r\n   map:m,\r\n   query: {\r\n        select: 'poly',\r\n        from:\"1Nmn4ITGyXRucIE52dt55mEhy7RWKm_s55f3dOhg\"\r\n        },\r\n    });\r\n  marker = new g.Marker({\r\n     map:m,\r\n position:center,\r\n title:\"address\"\r\n     \r\n     });\r\n    g.event.addListener(p, 'click',function(event){cb(event.latLng);});\r\n}\r\n\r\nfunction sMap(j){\r\n    poly= new g.Polygon({fillColor:\"#f6b26b\",\r\n    fillOpacity:0.4,\r\n    strokeWeight:0,\r\n    clickable:false,\r\n        paths: $.map(j.geometry.coordinates[0],function(v){\r\n            return new g.LatLng(v[1],v[0]);}),\r\n    map:m\r\n    });\r\n    \r\n}\r\nfunction uiStuff(){\r\n $( \"input:submit\" ).button();\r\n$('input, textarea').placeholder();\r\n$( \"#tabs\" ).tabs();\r\n$(\"#srch\").click(function(){\r\n    gc(\r\n        $(\"#adr\").val()\r\n        )\r\n    });\r\n}\r\n});\r\n"]],"start1":0,"start2":0,"length1":0,"length2":3454}]],"length":3454}
